<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>服務案例展示</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <link rel="stylesheet" href="css/cases-style.css" />

  <style>
    /* ===== 全域：穩定背景（避免拉動出現黑塊） ===== */
    html, body { height: 100%; }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Noto Sans TC', 'Segoe UI', sans-serif;
      color: #f0f0f0;
      background: #1e1f26; /* 只留底色，圖片改由偽元素承載 */
    }
    /* 背景圖層：放在第 0 層 */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      background: url('img/住宅01.jpg') center / cover no-repeat;
      z-index: 0;
      pointer-events: none;   /* 不阻擋點擊 */
      will-change: transform;
    }
    /* 前景容器：所有內容放這層（確保蓋在背景圖之上） */
    .page{
      position: relative;
      z-index: 1;
    }
    @media (max-width: 1024px){
      /* 行動裝置避免部分瀏覽器 fixed 破圖 */
      body::before{ background-attachment: scroll; }
    }

    /* ===== 導覽列 ===== */
    .top-nav {
      background-color: #333;
      color: white;
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo { color: white; text-decoration: none; font-size: 1.2rem; font-weight: bold; }
    .logo .mobile-only { display: none; }
    .logo .desktop-only { display: inline; }
    .hamburger {
      font-size: 1.8rem; background: none; color: white; border: none; cursor: pointer; display: none;top: 50%;transform: translateY(-50%);
    }
    .nav-links { list-style: none; display: flex; gap: 1.5rem; margin: 0; padding: 0; }
    .nav-links li a { color: white; text-decoration: none; font-size: 1rem; transition: color 0.3s ease; }
    .nav-links li a:hover { color: #f0c040; }

    @media (max-width: 768px) {
      .hamburger { display: block; }
      .nav-links {
        position: absolute; top: 60px; left: 0; right: 0;
        background-color: #333; flex-direction: column; align-items: center;
        display: none; padding: 1rem 0;
      }
      .nav-links.open { display: flex; }
      .logo .desktop-only { display: none; }
      .logo .mobile-only { display: inline; }
    }

    /* ===== 中間案例區塊（新版） ===== */
    :root{ --container:1200px; --nav-h:64px; --radius:12px; --gap:24px; }
    main.site-main{ flex:1; padding:32px 16px 56px; }
    .cases{
      max-width:var(--container); margin:0 auto;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius);
      padding:32px 16px 28px;
    }
    .cases__title{ text-align:center; margin:0 0 24px; }
    p, h1 { line-height: 1.7; letter-spacing: 0.5px; word-spacing: 2px; }

    .grid{ display:grid; gap:var(--gap); grid-template-columns:repeat(12,1fr); }
    .card{
      grid-column:span 4;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius); overflow:hidden; cursor:pointer;
      transition:transform .2s, box-shadow .2s, border-color .2s;
    }
    .card:hover{ transform: translateY(-2px); box-shadow:0 10px 30px rgba(0,0,0,.35); border-color:rgba(255,255,255,.18); }
    .card__img{ width:100%; aspect-ratio:4/3; object-fit:cover; display:block; }
    .card__body{ padding:16px; }
    .card__title{ margin:0 0 8px; font-size:1.05rem; }
    .card__desc{ margin:0; opacity:.95; }
    @media (max-width:1024px){ .card{ grid-column:span 6; } }
    @media (max-width:640px){ .card{ grid-column:span 12; } }

    /* ===== 回頂按鈕 ===== */
    #backToTop {
      position: fixed; bottom: 40px; right: 40px; display: none;
      font-size: 1.5rem; padding: 10px 15px; background-color: #333; color: white;
      border: none; border-radius: 50%; cursor: pointer; z-index: 1000;
    }
    #backToTop.show { display: block; }

    /* ===== Modal（新版：用 .is-open 控制） ===== */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1200; }
    .modal.is-open{ display:flex; }
    .modal__backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.8); z-index:0; }
    .modal__dialog{
      position:relative; z-index:1; width:min(92vw, 840px);
      background:#222; border-radius:12px; padding:20px 20px 24px;
      border:1px solid rgba(255,255,255,.06);
    }
    .modal__close{ position:absolute; top:10px; right:14px; font-size:1.8rem; color:#fff; background:none; border:0; cursor:pointer; z-index:3; }
    .modal__title{ margin:14px 0 6px; }
    .modal__desc{ margin:0 0 6px; opacity:.95; }

    .swiper{ width:100%; height:auto; position:relative; }
    .swiper-slide img{ width:100%; max-height:420px; object-fit:contain; }
    .swiper-button-next, .swiper-button-prev, .swiper-pagination{ z-index:2; }
    .swiper-slide {display: flex;justify-content: center;align-items: center;}
    /* ===== 頁尾 ===== */
    .footer {
      background-color: #f0f0f0;
      padding: 1rem;
      text-align: center;
      font-size: 0.9rem;
      color: #333;
    }
    .footer p {
      font-size: clamp(12px, 2vw, 16px); /* 最小 12px，隨螢幕寬度變化，最大 16px */
      white-space: nowrap;               /* 禁止自動換行 */
      overflow: hidden;                  /* 避免超出容器 */
      text-overflow: ellipsis;           /* 超出時用 ... 表示，可選 */
    }
  </style>
</head>

<body>
  <!-- 前景容器開始：把整個頁面內容包起來 -->
  <div class="page">
    <!-- 回頂按鈕 -->
    <button id="backToTop" title="回到頂部">⬆</button>

    <!-- 導覽列 -->
    <nav class="top-nav">
      <div class="nav-container">
        <a href="index.html" class="logo"><span class="mobile-only">裕傢室內裝修有限公司</span></a>
        <button class="hamburger" id="hamburger" aria-label="開啟選單">☰</button>
        <ul class="nav-links" id="navMenu">
          <li><a href="index.html">首頁</a></li>
          <li><a href="about.html">關於我們</a></li>
          <li><a href="services.html">服務內容</a></li>
          <li><a href="cases.html" aria-current="page">服務案例</a></li>
          <li><a href="contact.html">聯絡我們</a></li>
          <li><a href="https://www.1111.com.tw/corp/67789982" target="_blank" rel="noopener">加入我們</a></li>
        </ul>
      </div>
    </nav>

    <!-- 中間案例區塊 -->
    
    <main class="site-main" id="mainContent" tabindex="-1">
      <section class="cases" aria-labelledby="casesTitle">
        <h1 class="cases__title" id="casesTitle">服務案例總覽</h1>
        <div class="grid" id="caseGrid"></div>
      </section>
    </main>

    <!-- Modal -->
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc" hidden>
      <div class="modal__backdrop" data-close="backdrop"></div>
      <div class="modal__dialog" tabindex="-1">
        <button class="modal__close" id="modalClose" aria-label="關閉">×</button>
        <div class="swiper">
          <div class="swiper-wrapper"></div>
          <div class="swiper-pagination"></div>
          <div class="swiper-button-next" aria-label="下一張"></div>
          <div class="swiper-button-prev" aria-label="上一張"></div>
        </div>
        <h2 class="modal__title" id="modalTitle"></h2>
        <p class="modal__desc" id="modalDesc"></p>
      </div>
    </div>

    <!-- 頁尾 -->
    <footer class="footer">
      <p class="center-text">版權所有 © 裕傢室內裝修有限公司｜Designed by 要留儀翰 網頁設計</p>
    </footer>
  </div>
  <!-- 前景容器結束 -->

  <!-- 套件 -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <!-- 網站互動（選單 / 回頂） -->
  <script>
    // 漢堡選單切換
    document.getElementById("hamburger").addEventListener("click", function () {
      const menu = document.getElementById("navMenu");
      const open = menu.classList.toggle("open");
      this.setAttribute("aria-expanded", open ? "true" : "false");
    });

    // 回頂按鈕
    window.addEventListener('scroll', function () {
      const btn = document.getElementById("backToTop");
      if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
        btn.classList.add("show");
      } else {
        btn.classList.remove("show");
      }
    }, { passive: true });
    document.getElementById("backToTop").onclick = function () {
      window.scrollTo({ top: 0, behavior: "smooth" });
    };
  </script>

  <!-- 服務案例（私有作用域，避免 let swiper 重複宣告） -->
  <script>
  (function () {
    const CASES = [
      { title:"🔹 XX醫院裝修案", desc:"本案為醫療空間整合設計，涵蓋診間、候診室與無障礙動線配置。", images:["img/住宅01.jpg","img/住宅02.jpg","img/住宅03.jpg"] },
      { title:"🔹 OO企業辦公室", desc:"以機能性與開放空間為主軸，規劃辦公桌、會議室與接待區域。", images:["img/學校01.jpg","img/學校02.jpg","img/學校03.jpg"] },
      { title:"🔹 OO企業辦公室", desc:"以機能性與開放空間為主軸，規劃辦公桌、會議室與接待區域。", images:["img/辦公室01.jpg","img/辦公室02.jpg","img/辦公室03.jpg"] },
      { title:"🔹 OO企業辦公室", desc:"以機能性與開放空間為主軸，規劃辦公桌、會議室與接待區域。", images:["img/醫院01.jpg","img/醫院02.jpg","img/醫院03.jpg"] },
      { title:"🔹 OO企業辦公室", desc:"以機能性與開放空間為主軸，規劃辦公桌、會議室與接待區域。", images:["img/廠房01.jpg","img/廠房02.jpg","img/廠房03.jpg"] },
      { title:"🔹 OO企業辦公室", desc:"以機能性與開放空間為主軸，規劃辦公桌、會議室與接待區域。", images:["img/住家01.jpg","img/住家02.jpg","img/住家03.jpg"] }
    ];

    // 渲染卡片
    const grid = document.getElementById('caseGrid');
    grid.innerHTML = CASES.map((c,i)=>`
      <article class="card" data-index="${i}" tabindex="0" aria-labelledby="card-title-${i}">
        <img class="card__img" src="${c.images[0]}" alt="案例預覽：${c.title}" loading="lazy">
        <div class="card__body">
          <h3 class="card__title" id="card-title-${i}">${c.title}</h3>
          <p class="card__desc">${c.desc}</p>
        </div>
      </article>
    `).join('');

    // Modal + Swiper（不汙染全域）
    const modal = document.getElementById('modal');
    const modalDialog = modal.querySelector('.modal__dialog');
    const modalClose = document.getElementById('modalClose');
    const swiperEl = modal.querySelector('.swiper');
    let swiper;

    function mountSlides(images, title){
      const slides = images.map(src => `<div class="swiper-slide"><img src="${src}" alt="${title} 圖片" loading="lazy"></div>`);
      const paginationEl = modal.querySelector('.swiper-pagination');
      const nextEl = modal.querySelector('.swiper-button-next');
      const prevEl = modal.querySelector('.swiper-button-prev');

      if(!swiper){
        swiper = new Swiper(swiperEl, {
          loop: true,
          pagination: { el: paginationEl },
          navigation: { nextEl, prevEl }
        });
        swiper.appendSlide(slides);
      }else{
        swiper.removeAllSlides();
        swiper.appendSlide(slides);
        swiper.updateSlides();
        swiper.update();
        swiper.navigation.update();
        swiper.pagination.render();
        swiper.pagination.update();
        swiper.slideToLoop(0, 0);
      }
    }

    function openModal(index){
      const item = CASES[index];
      modal.hidden = false;
      modal.classList.add('is-open');

      document.getElementById('modalTitle').textContent = item.title;
      document.getElementById('modalDesc').textContent = item.desc;

      mountSlides(item.images, item.title);

      modalDialog.focus();
      document.addEventListener('keydown', trapFocus);
    }

    function closeModal(){
      modal.classList.remove('is-open');
      modal.hidden = true;
      document.removeEventListener('keydown', trapFocus);
      const main = document.getElementById('mainContent');
      if(main) main.focus({ preventScroll:true });
    }

    // 卡片事件委派（點擊/Enter 開啟）
    grid.addEventListener('click', (e)=>{
      const card = e.target.closest('.card');
      if(card) openModal(Number(card.dataset.index));
    });
    grid.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){
        const card = e.target.closest('.card');
        if(card) openModal(Number(card.dataset.index));
      }
    });

    // 關閉 Modal：按鈕、背景、Esc
    modalClose.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{ if(e.target.dataset.close === 'backdrop') closeModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && modal.classList.contains('is-open')) closeModal(); });

    // 焦點陷阱（可存取）
    function trapFocus(e){
      if(e.key !== 'Tab' || !modal.classList.contains('is-open')) return;
      const focusables = modalDialog.querySelectorAll('a, button, textarea, input, select, [tabindex]:not([tabindex="-1"])');
      const first = focusables[0];
      const last = focusables[focusables.length - 1];
      if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
      else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
    }
  })();
  </script>
</body>
</html>
